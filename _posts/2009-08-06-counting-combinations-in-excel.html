---
layout: post
root: ../../..
title: "Counting Combinations in Excel"
date: 2009-08-06 09:05:02
---
Dear LazyWeb,

I have a spreadsheet laid out as follows:
<table border="0">
<tbody>
<tr>
<td></td>
<td><strong>A</strong></td>
<td><strong>B</strong></td>
<td><strong>C</strong></td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>User</td>
<td>First</td>
<td>Second</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>turing</td>
<td>red</td>
<td>up</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>hopper</td>
<td>blue</td>
<td>down</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>zuse</td>
<td>red</td>
<td>up</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>knuth</td>
<td>blue</td>
<td>up</td>
</tr>
</tbody></table>
I'd like to generate another table counting choice pairs:
<table border="0">
<tbody>
<tr>
<td></td>
<td><strong>100</strong></td>
<td><strong>101</strong></td>
<td><strong>102</strong></td>
</tr>
<tr>
<td><strong>X</strong></td>
<td></td>
<td>red</td>
<td>blue</td>
</tr>
<tr>
<td><strong>Y</strong></td>
<td>up</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td><strong>Z</strong></td>
<td>down</td>
<td>0</td>
<td>1</td>
</tr>
</tbody></table>
There are going to be about eight values for 'First', and about a dozen for 'Second', so I don't mind typing in the row/column headers for the second table. What I want is something like a double-barrelled COUNTIF(), but there doesn't appear to be one. I've tried constructing an extra column joining the two choice values:
<table border="0">
<tbody>
<tr>
<td></td>
<td><strong>A</strong></td>
<td><strong>B</strong></td>
<td><strong>C</strong></td>
<td><strong>D</strong></td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>User</td>
<td>First</td>
<td>Second</td>
<td>_joined_</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>turing</td>
<td>red</td>
<td>up</td>
<td>red:up</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>hopper</td>
<td>blue</td>
<td>down</td>
<td>blue:down</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>zuse</td>
<td>red</td>
<td>up</td>
<td>red:up</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>knuth</td>
<td>blue</td>
<td>up</td>
<td>blue:up</td>
</tr>
</tbody></table>
and then doing COUNTIF(D2:D5,=CONCATENATE(something,':',something)). However, I can't put a CONCATENATE or any other function call in the second half of a COUNTIF (though you can compare to a cell value using something like "&gt;="&amp;A5, and yes, the quotes are supposed to be where they are). I also can't figure out what the something's should be to look up the two items to concatenate.

So, how <em>should</em> I do this?  And please don't say "use a relational database" --- I've got some constraints here.
